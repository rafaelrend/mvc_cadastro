(function($){$.addFlex=function(t,p){if(t.grid)return false;p=$.extend({height:200,width:'auto',striped:true,novstripe:false,minwidth:30,minheight:80,resizable:true,url:false,method:'POST',dataType:'xml',errormsg:'Connection Error',usepager:false,nowrap:true,page:1,total:1,useRp:true,rp:15,rpOptions:[10,15,20,25,40],title:false,pagestat:'Displaying {from} to {to} of {total} items',procmsg:'Processing, please wait ...',query:'',qtype:'',nomsg:'No items',minColToggle:1,showToggleBtn:true,hideOnSubmit:true,autoload:true,blockOpacity:0.5,onToggleCol:false,onChangeSort:false,onSuccess:false,onSubmit:false,msgSearch:'Quick Search',msgBtnClear:'Clear',callbackRsAjax:null,paramsCallbackAjax:{}},p);$(t).show().attr({cellPadding:0,cellSpacing:0,border:0}).removeAttr('width');var g={hset:{},rePosDrag:function(){var c=0-this.hDiv.scrollLeft;if(this.hDiv.scrollLeft>0)c-=Math.floor(p.cgwidth/2);$(g.cDrag).css({top:g.hDiv.offsetTop+1});var d=this.cdpad;$('div',g.cDrag).hide();$('thead tr:first th:visible',this.hDiv).each(function(){var n=$('thead tr:first th:visible',g.hDiv).index(this);var a=parseInt($('div',this).width());var b=a;if(c==0)c-=Math.floor(p.cgwidth/2);a=a+c+d;$('div:eq('+n+')',g.cDrag).css({'left':a+'px'}).show();c=a})},fixHeight:function(a){a=false;if(!a)a=$(g.bDiv).height();var b=$(this.hDiv).height();$('div',this.cDrag).each(function(){$(this).height(a+b)});var c=parseInt($(g.nDiv).height());if(c>a)$(g.nDiv).height(a).width(200);else $(g.nDiv).height('auto').width('auto');$(g.block).css({height:a,marginBottom:(a*-1)});var d=g.bDiv.offsetTop+a;if(p.height!='auto'&&p.resizable)d=g.vDiv.offsetTop;$(g.rDiv).css({height:d})},dragStart:function(a,e,b){if(a=='colresize'){$(g.nDiv).hide();$(g.nBtn).hide();var n=$('div',this.cDrag).index(b);var c=$('th:visible div:eq('+n+')',this.hDiv).width();$(b).addClass('dragging').siblings().hide();$(b).prev().addClass('dragging').show();this.colresize={startX:e.pageX,ol:parseInt(b.style.left),ow:c,n:n};$('body').css('cursor','col-resize')}else if(a=='vresize'){var d=false;$('body').css('cursor','row-resize');if(b){d=true;$('body').css('cursor','col-resize')}this.vresize={h:p.height,sy:e.pageY,w:p.width,sx:e.pageX,hgo:d}}else if(a=='colMove'){$(g.nDiv).hide();$(g.nBtn).hide();this.hset=$(this.hDiv).offset();this.hset.right=this.hset.left+$('table',this.hDiv).width();this.hset.bottom=this.hset.top+$('table',this.hDiv).height();this.dcol=b;this.dcoln=$('th',this.hDiv).index(b);this.colCopy=document.createElement("div");this.colCopy.className="colCopy";this.colCopy.innerHTML=b.innerHTML;if($.browser.msie){this.colCopy.className="colCopy ie"}$(this.colCopy).css({position:'absolute',float:'left',display:'none',textAlign:b.align});$('body').append(this.colCopy);$(this.cDrag).hide()}$('body').noSelect()},dragMove:function(e){if(this.colresize){var n=this.colresize.n;var a=e.pageX-this.colresize.startX;var b=this.colresize.ol+a;var c=this.colresize.ow+a;if(c>p.minwidth){$('div:eq('+n+')',this.cDrag).css('left',b);this.colresize.nw=c}}else if(this.vresize){var v=this.vresize;var y=e.pageY;var a=y-v.sy;if(!p.defwidth)p.defwidth=p.width;if(p.width!='auto'&&!p.nohresize&&v.hgo){var x=e.pageX;var d=x-v.sx;var f=v.w+d;if(f>p.defwidth){this.gDiv.style.width=f+'px';p.width=f}}var g=v.h+a;if((g>p.minheight||p.height<p.minheight)&&!v.hgo){this.bDiv.style.height=g+'px';p.height=g;this.fixHeight(g)}v=null}else if(this.colCopy){$(this.dcol).addClass('thMove').removeClass('thOver');if(e.pageX>this.hset.right||e.pageX<this.hset.left||e.pageY>this.hset.bottom||e.pageY<this.hset.top){$('body').css('cursor','move')}else $('body').css('cursor','pointer');$(this.colCopy).css({top:e.pageY+10,left:e.pageX+20,display:'block'})}},dragEnd:function(){if(this.colresize){var n=this.colresize.n;var a=this.colresize.nw;$('th:visible div:eq('+n+')',this.hDiv).css('width',a);$('tr',this.bDiv).each(function(){$('td:visible div:eq('+n+')',this).css('width',a)});this.hDiv.scrollLeft=this.bDiv.scrollLeft;$('div:eq('+n+')',this.cDrag).siblings().show();$('.dragging',this.cDrag).removeClass('dragging');this.rePosDrag();this.fixHeight();this.colresize=false}else if(this.vresize){this.vresize=false}else if(this.colCopy){$(this.colCopy).remove();if(this.dcolt!=null){if(this.dcoln>this.dcolt)$('th:eq('+this.dcolt+')',this.hDiv).before(this.dcol);else $('th:eq('+this.dcolt+')',this.hDiv).after(this.dcol);this.switchCol(this.dcoln,this.dcolt);$(this.cdropleft).remove();$(this.cdropright).remove();this.rePosDrag()}this.dcol=null;this.hset=null;this.dcoln=null;this.dcolt=null;this.colCopy=null;$('.thMove',this.hDiv).removeClass('thMove');$(this.cDrag).show()}$('body').css('cursor','default');$('body').noSelect(false)},toggleCol:function(a,b){var c=$("th[axis='col"+a+"']",this.hDiv)[0];var n=$('thead th',g.hDiv).index(c);var d=$('input[value='+a+']',g.nDiv)[0];if(b==null){b=c.hide}if($('input:checked',g.nDiv).length<p.minColToggle&&!b)return false;if(b){c.hide=false;$(c).show();d.checked=true}else{c.hide=true;$(c).hide();d.checked=false}$('tbody tr',t).each(function(){if(b)$('td:eq('+n+')',this).show();else $('td:eq('+n+')',this).hide()});this.rePosDrag();if(p.onToggleCol)p.onToggleCol(a,b);return b},switchCol:function(a,b){$('tbody tr',t).each(function(){if(a>b)$('td:eq('+b+')',this).before($('td:eq('+a+')',this));else $('td:eq('+b+')',this).after($('td:eq('+a+')',this))});if(a>b)$('tr:eq('+b+')',this.nDiv).before($('tr:eq('+a+')',this.nDiv));else $('tr:eq('+b+')',this.nDiv).after($('tr:eq('+a+')',this.nDiv));if($.browser.msie&&$.browser.version<7.0)$('tr:eq('+b+') input',this.nDiv)[0].checked=true;this.hDiv.scrollLeft=this.bDiv.scrollLeft},scroll:function(){this.hDiv.scrollLeft=this.bDiv.scrollLeft;this.rePosDrag()},addData:function(f){if(p.preProcess)f=p.preProcess(f);$('.pReload',this.pDiv).removeClass('loading');this.loading=false;if(!f){$('.pPageStat',this.pDiv).html(p.errormsg);return false}if(p.dataType=='xml')p.total=+$('rows total',f).text();else p.total=f.total;if(p.total==0){$('tr, a, td, div',t).unbind();$(t).empty();p.pages=1;p.page=1;this.buildpager();$('.pPageStat',this.pDiv).html(p.nomsg);return false}p.pages=Math.ceil(p.total/p.rp);if(p.dataType=='xml')p.page=+$('rows page',f).text();else p.page=f.page;this.buildpager();var h=document.createElement('tbody');if(p.dataType=='json'){$.each(f.rows,function(i,c){var d=document.createElement('tr');if(i%2&&p.striped)d.className='erow';if(c.id)d.id='row'+c.id;$('thead tr:first th',g.hDiv).each(function(){var a=document.createElement('td');var b=$(this).attr('axis').substr(3);a.align=this.align;a.innerHTML=c.cell[b];$(d).append(a);a=null});if($('thead',this.gDiv).length<1){for(idx=0;idx<cell.length;idx++){var e=document.createElement('td');e.innerHTML=c.cell[idx];$(d).append(e);e=null}}$(h).append(d);d=null})}else if(p.dataType=='xml'){i=1;$("rows row",f).each(function(){i++;var c=document.createElement('tr');if(i%2&&p.striped)c.className='erow';var d=$(this).attr('id');if(d)c.id='row'+d;d=null;var e=this;$('thead tr:first th',g.hDiv).each(function(){var a=document.createElement('td');var b=$(this).attr('axis').substr(3);a.align=this.align;a.innerHTML=$("cell:eq("+b+")",e).text();$(c).append(a);a=null});if($('thead',this.gDiv).length<1){$('cell',this).each(function(){var a=document.createElement('td');a.innerHTML=$(this).text();$(c).append(a);a=null})}$(h).append(c);c=null;e=null})}$('tr',t).unbind();$(t).empty();$(t).append(h);this.addCellProp();this.addRowProp();this.rePosDrag();h=null;f=null;i=null;if(p.onSuccess)p.onSuccess();if(p.hideOnSubmit)$(g.block).remove();this.hDiv.scrollLeft=this.bDiv.scrollLeft;if($.browser.opera)$(t).css('visibility','visible')},changeSort:function(a){if(this.loading)return true;$(g.nDiv).hide();$(g.nBtn).hide();if(p.sortname==$(a).attr('abbr')){if(p.sortorder=='asc')p.sortorder='desc';else p.sortorder='asc'}$(a).addClass('sorted').siblings().removeClass('sorted');$('.sdesc',this.hDiv).removeClass('sdesc');$('.sasc',this.hDiv).removeClass('sasc');$('div',a).addClass('s'+p.sortorder);p.sortname=$(a).attr('abbr');if(p.onChangeSort)p.onChangeSort(p.sortname,p.sortorder);else this.populate()},buildpager:function(){$('.pcontrol input',this.pDiv).val(p.page);$('.pcontrol span',this.pDiv).html(p.pages);var a=(p.page-1)*p.rp+1;var b=a+p.rp-1;if(p.total<b)b=p.total;var c=p.pagestat;c=c.replace(/{from}/,a);c=c.replace(/{to}/,b);c=c.replace(/{total}/,p.total);$('.pPageStat',this.pDiv).html(c)},populate:function(){if(this.loading)return true;if(p.onSubmit){var c=p.onSubmit();if(!c)return false}this.loading=true;if(!p.url)return false;$('.pPageStat',this.pDiv).html(p.procmsg);$('.pReload',this.pDiv).addClass('loading');$(g.block).css({top:g.bDiv.offsetTop});if(p.hideOnSubmit)$(this.gDiv).prepend(g.block);if($.browser.opera)$(t).css('visibility','hidden');if(!p.newp)p.newp=1;if(p.page>p.pages)p.page=p.pages;var d=[{name:'page',value:p.newp},{name:'rp',value:p.rp},{name:'sortname',value:p.sortname},{name:'sortorder',value:p.sortorder},{name:'query',value:p.query},{name:'qtype',value:p.qtype}];if(p.params){for(var f=0;f<p.params.length;f++)d[d.length]=p.params[f]}$.ajax({type:p.method,url:p.url,data:d,dataType:p.dataType,success:function(a){g.addData(a);if('callbackRsAjax'in p){var b=eval("("+p.callbackRsAjax+")");(typeof b=='function')?b(p.paramsCallbackAjax):null}},error:function(a){try{if(p.onError)p.onError(a)}catch(e){}}})},doSearch:function(){p.query=$('input[name=q]',g.sDiv).val();p.qtype=$('select[name=qtype]',g.sDiv).val();p.newp=1;this.populate()},changePage:function(a){if(this.loading)return true;switch(a){case'first':p.newp=1;break;case'prev':if(p.page>1)p.newp=parseInt(p.page)-1;break;case'next':if(p.page<p.pages)p.newp=parseInt(p.page)+1;break;case'last':p.newp=p.pages;break;case'input':var b=parseInt($('.pcontrol input',this.pDiv).val());if(isNaN(b))b=1;if(b<1)b=1;else if(b>p.pages)b=p.pages;$('.pcontrol input',this.pDiv).val(b);p.newp=b;break}if(p.newp==p.page)return false;if(p.onChangePage)p.onChangePage(p.newp);else this.populate()},addCellProp:function(){$('tbody tr td',g.bDiv).each(function(){var a=document.createElement('div');var n=$('td',$(this).parent()).index(this);var b=$('th:eq('+n+')',g.hDiv).get(0);if(b!=null){if(p.sortname==$(b).attr('abbr')&&p.sortname){this.className='sorted'}$(a).css({textAlign:b.align,width:$('div:first',b)[0].style.width});if(b.hide)$(this).css('display','none')}if(p.nowrap==false)$(a).css('white-space','normal');if(this.innerHTML=='')this.innerHTML='&nbsp;';a.innerHTML=this.innerHTML;var c=$(this).parent()[0];var d=false;if(c.id)d=c.id.substr(3);if(b!=null){if(b.process)b.process(a,d)}$(this).empty().append(a).removeAttr('width')})},getCellDim:function(a){var b=parseInt($(a).height());var c=parseInt($(a).parent().height());var d=parseInt(a.style.width);var e=parseInt($(a).parent().width());var f=a.offsetParent.offsetTop;var g=a.offsetParent.offsetLeft;var h=parseInt($(a).css('paddingLeft'));var i=parseInt($(a).css('paddingTop'));return{ht:b,wt:d,top:f,left:g,pdl:h,pdt:i,pht:c,pwt:e}},addRowProp:function(){$('tbody tr',g.bDiv).each(function(){$(this).click(function(e){var a=(e.target||e.srcElement);if(a.href||a.type)return true;$(this).toggleClass('trSelected');if(p.singleSelect)$(this).siblings().removeClass('trSelected')}).mousedown(function(e){if(e.shiftKey){$(this).toggleClass('trSelected');g.multisel=true;this.focus();$(g.gDiv).noSelect()}}).mouseup(function(){if(g.multisel){g.multisel=false;$(g.gDiv).noSelect(false)}}).hover(function(e){if(g.multisel){$(this).toggleClass('trSelected')}},function(){});if($.browser.msie&&$.browser.version<7.0){$(this).hover(function(){$(this).addClass('trOver')},function(){$(this).removeClass('trOver')})}})},pager:0};if(p.colModel){q=document.createElement('thead');tr=document.createElement('tr');for(i=0;i<p.colModel.length;i++){var j=p.colModel[i];var k=document.createElement('th');k.innerHTML=j.display;if(j.name&&j.sortable)$(k).attr('abbr',j.name);$(k).attr('axis','col'+i);if(j.align)k.align=j.align;if(j.width)$(k).attr('width',j.width);if(j.hide){k.hide=true}if(j.process){k.process=j.process}$(tr).append(k)}$(q).append(tr);$(t).prepend(q)}g.gDiv=document.createElement('div');g.mDiv=document.createElement('div');g.hDiv=document.createElement('div');g.bDiv=document.createElement('div');g.vDiv=document.createElement('div');g.rDiv=document.createElement('div');g.cDrag=document.createElement('div');g.block=document.createElement('div');g.nDiv=document.createElement('div');g.nBtn=document.createElement('div');g.iDiv=document.createElement('div');g.tDiv=document.createElement('div');g.sDiv=document.createElement('div');if(p.usepager)g.pDiv=document.createElement('div');g.hTable=document.createElement('table');g.gDiv.className='flexigrid';if(p.width!='auto')g.gDiv.style.width=p.width+'px';if($.browser.msie)$(g.gDiv).addClass('ie');if(p.novstripe)$(g.gDiv).addClass('novstripe');$(t).before(g.gDiv);$(g.gDiv).append(t);if(p.buttons){g.tDiv.className='tDiv';var l=document.createElement('div');l.className='tDiv2';for(i=0;i<p.buttons.length;i++){var m=p.buttons[i];if(!m.separator){var o=document.createElement('div');o.className='fbutton';o.innerHTML="<div><span>"+m.name+"</span></div>";if(m.bclass)$('span',o).addClass(m.bclass).css({paddingLeft:20});o.onpress=m.onpress;o.name=m.name;if(m.onpress){$(o).click(function(){this.onpress(this.name,g.gDiv)})}$(l).append(o);if($.browser.msie&&$.browser.version<7.0){$(o).hover(function(){$(this).addClass('fbOver')},function(){$(this).removeClass('fbOver')})}}else{$(l).append("<div class='btnseparator'></div>")}}$(g.tDiv).append(l);$(g.tDiv).append("<div style='clear:both'></div>");$(g.gDiv).prepend(g.tDiv)}g.hDiv.className='hDiv';$(t).before(g.hDiv);g.hTable.cellPadding=0;g.hTable.cellSpacing=0;$(g.hDiv).append('<div class="hDivBox"></div>');$('div',g.hDiv).append(g.hTable);var q=$("thead:first",t).get(0);if(q)$(g.hTable).append(q);q=null;if(!p.colmodel)var r=0;$('thead tr:first th',g.hDiv).each(function(){var f=document.createElement('div');if($(this).attr('abbr')){$(this).click(function(e){if(!$(this).hasClass('thOver'))return false;var a=(e.target||e.srcElement);if(a.href||a.type)return true;g.changeSort(this)});if($(this).attr('abbr')==p.sortname){this.className='sorted';f.className='s'+p.sortorder}}if(this.hide)$(this).hide();if(!p.colmodel){$(this).attr('axis','col'+r++)}$(f).css({textAlign:this.align,width:this.width+'px'});f.innerHTML=this.innerHTML;$(this).empty().append(f).removeAttr('width').mousedown(function(e){g.dragStart('colMove',e,this)}).hover(function(){if(!g.colresize&&!$(this).hasClass('thMove')&&!g.colCopy)$(this).addClass('thOver');if($(this).attr('abbr')!=p.sortname&&!g.colCopy&&!g.colresize&&$(this).attr('abbr'))$('div',this).addClass('s'+p.sortorder);else if($(this).attr('abbr')==p.sortname&&!g.colCopy&&!g.colresize&&$(this).attr('abbr')){var a='';if(p.sortorder=='asc')a='desc';else a='asc';$('div',this).removeClass('s'+p.sortorder).addClass('s'+a)}if(g.colCopy){var n=$('th',g.hDiv).index(this);if(n==g.dcoln)return false;if(n<g.dcoln)$(this).append(g.cdropleft);else $(this).append(g.cdropright);g.dcolt=n}else if(!g.colresize){var b=$('th:visible',g.hDiv).index(this);var c=parseInt($('div:eq('+b+')',g.cDrag).css('left'));var d=parseInt($(g.nBtn).width())+parseInt($(g.nBtn).css('borderLeftWidth'));nl=c-d+Math.floor(p.cgwidth/2);$(g.nBtn).css({'left':nl,top:g.hDiv.offsetTop}).show();var e=parseInt($(g.nDiv).width());$(g.nDiv).css({top:g.bDiv.offsetTop});if((nl+e)>$(g.gDiv).width())$(g.nDiv).css('left',c-e+1);else $(g.nDiv).css('left',nl);if($(this).hasClass('sorted'))$(g.nBtn).addClass('srtd');else $(g.nBtn).removeClass('srtd')}},function(){$(this).removeClass('thOver');if($(this).attr('abbr')!=p.sortname)$('div',this).removeClass('s'+p.sortorder);else if($(this).attr('abbr')==p.sortname){var a='';if(p.sortorder=='asc')a='desc';else a='asc';$('div',this).addClass('s'+p.sortorder).removeClass('s'+a)}if(g.colCopy){$(g.cdropleft).remove();$(g.cdropright).remove();g.dcolt=null}})});g.bDiv.className='bDiv';$(t).before(g.bDiv);$(g.bDiv).css({height:(p.height=='auto')?'auto':p.height+"px"}).scroll(function(e){g.scroll()}).append(t);if(p.height=='auto'){$('table',g.bDiv).addClass('autoht')}g.addCellProp();g.addRowProp();var u=$('thead tr:first th:first',g.hDiv).get(0);if(u!=null){g.cDrag.className='cDrag';g.cdpad=0;g.cdpad+=(isNaN(parseInt($('div',u).css('borderLeftWidth')))?0:parseInt($('div',u).css('borderLeftWidth')));g.cdpad+=(isNaN(parseInt($('div',u).css('borderRightWidth')))?0:parseInt($('div',u).css('borderRightWidth')));g.cdpad+=(isNaN(parseInt($('div',u).css('paddingLeft')))?0:parseInt($('div',u).css('paddingLeft')));g.cdpad+=(isNaN(parseInt($('div',u).css('paddingRight')))?0:parseInt($('div',u).css('paddingRight')));g.cdpad+=(isNaN(parseInt($(u).css('borderLeftWidth')))?0:parseInt($(u).css('borderLeftWidth')));g.cdpad+=(isNaN(parseInt($(u).css('borderRightWidth')))?0:parseInt($(u).css('borderRightWidth')));g.cdpad+=(isNaN(parseInt($(u).css('paddingLeft')))?0:parseInt($(u).css('paddingLeft')));g.cdpad+=(isNaN(parseInt($(u).css('paddingRight')))?0:parseInt($(u).css('paddingRight')));$(g.bDiv).before(g.cDrag);var w=$(g.bDiv).height();var z=$(g.hDiv).height();$(g.cDrag).css({top:-z+'px'});$('thead tr:first th',g.hDiv).each(function(){var a=document.createElement('div');$(g.cDrag).append(a);if(!p.cgwidth)p.cgwidth=$(a).width();$(a).css({height:w+z}).mousedown(function(e){g.dragStart('colresize',e,this)});if($.browser.msie&&$.browser.version<7.0){g.fixHeight($(g.gDiv).height());$(a).hover(function(){g.fixHeight();$(this).addClass('dragging')},function(){if(!g.colresize)$(this).removeClass('dragging')})}})}if(p.striped)$('tbody tr:odd',g.bDiv).addClass('erow');if(p.resizable&&p.height!='auto'){g.vDiv.className='vGrip';$(g.vDiv).mousedown(function(e){g.dragStart('vresize',e)}).html('<span></span>');$(g.bDiv).after(g.vDiv)}if(p.resizable&&p.width!='auto'&&!p.nohresize){g.rDiv.className='hGrip';$(g.rDiv).mousedown(function(e){g.dragStart('vresize',e,true)}).html('<span></span>').css('height',$(g.gDiv).height());if($.browser.msie&&$.browser.version<7.0){$(g.rDiv).hover(function(){$(this).addClass('hgOver')},function(){$(this).removeClass('hgOver')})}$(g.gDiv).append(g.rDiv)}if(p.usepager){g.pDiv.className='pDiv';g.pDiv.innerHTML='<div class="pDiv2"></div>';$(g.bDiv).after(g.pDiv);var A=' <div class="pGroup"> <div class="pFirst pButton"><span></span></div><div class="pPrev pButton"><span></span></div> </div> <div class="btnseparator"></div> <div class="pGroup"><span class="pcontrol">Pag <input type="text" size="4" value="1" /> of <span> 1 </span></span></div> <div class="btnseparator"></div> <div class="pGroup"> <div class="pNext pButton"><span></span></div><div class="pLast pButton"><span></span></div> </div> <div class="btnseparator"></div> <div class="pGroup"> <div class="pReload pButton"><span></span></div> </div> <div class="btnseparator"></div> <div class="pGroup"><span class="pPageStat"></span></div>';$('div',g.pDiv).html(A);$('.pReload',g.pDiv).click(function(){g.populate()});$('.pFirst',g.pDiv).click(function(){g.changePage('first')});$('.pPrev',g.pDiv).click(function(){g.changePage('prev')});$('.pNext',g.pDiv).click(function(){g.changePage('next')});$('.pLast',g.pDiv).click(function(){g.changePage('last')});$('.pcontrol input',g.pDiv).keydown(function(e){if(e.keyCode==13)g.changePage('input')});if($.browser.msie&&$.browser.version<7)$('.pButton',g.pDiv).hover(function(){$(this).addClass('pBtnOver')},function(){$(this).removeClass('pBtnOver')});if(p.useRp){var B="";for(var C=0;C<p.rpOptions.length;C++){if(p.rp==p.rpOptions[C])sel='selected="selected"';else sel='';B+="<option value='"+p.rpOptions[C]+"' "+sel+" >"+p.rpOptions[C]+"&nbsp;&nbsp;</option>"};$('.pDiv2',g.pDiv).prepend("<div class='pGroup'><select name='rp'>"+B+"</select></div> <div class='btnseparator'></div>");$('select',g.pDiv).change(function(){if(p.onRpChange)p.onRpChange(+this.value);else{p.newp=1;p.rp=+this.value;g.populate()}})}if(p.searchitems){$('.pDiv2',g.pDiv).prepend("<div class='pGroup'> <div class='pSearch pButton'><span></span></div> </div>  <div class='btnseparator'></div>");$('.pSearch',g.pDiv).click(function(){$(g.sDiv).slideToggle('fast',function(){$('.sDiv:visible input:first',g.gDiv).trigger('focus')})});g.sDiv.className='sDiv';sitems=p.searchitems;var D="";for(var s=0;s<sitems.length;s++){if(p.qtype==''&&sitems[s].isdefault==true){p.qtype=sitems[s].name;sel='selected="selected"'}else sel='';D+="<option value='"+sitems[s].name+"' "+sel+" >"+sitems[s].display+"&nbsp;&nbsp;</option>"}if(p.qtype=='')p.qtype=sitems[0].name;$(g.sDiv).append("<div class='sDiv2'>"+p.msgSearch+"<input type='text' size='30' name='q' class='qsbox' /> <select name='qtype'>"+D+"</select> <input type='button' value='"+p.msgBtnClear+"' /></div>");$('input[name=q],select[name=qtype]',g.sDiv).keydown(function(e){if(e.keyCode==13)g.doSearch()});$('input[value=Clear]',g.sDiv).click(function(){$('input[name=q]',g.sDiv).val('');p.query='';g.doSearch()});$(g.bDiv).after(g.sDiv)}}$(g.pDiv,g.sDiv).append("<div style='clear:both'></div>");if(p.title){g.mDiv.className='mDiv';g.mDiv.innerHTML='<div class="ftitle">'+p.title+'</div>';$(g.gDiv).prepend(g.mDiv);if(p.showTableToggleBtn){$(g.mDiv).append('<div class="ptogtitle" title="Minimize/Maximize Table"><span></span></div>');$('div.ptogtitle',g.mDiv).click(function(){$(g.gDiv).toggleClass('hideBody');$(this).toggleClass('vsble')})}}g.cdropleft=document.createElement('span');g.cdropleft.className='cdropleft';g.cdropright=document.createElement('span');g.cdropright.className='cdropright';g.block.className='gBlock';var E=$(g.bDiv).height();var F=g.bDiv.offsetTop;$(g.block).css({width:g.bDiv.style.width,height:E,background:'white',position:'relative',marginBottom:(E*-1),zIndex:1,top:F,left:'0px'});$(g.block).fadeTo(0,p.blockOpacity);if($('th',g.hDiv).length){g.nDiv.className='nDiv';g.nDiv.innerHTML="<table cellpadding='0' cellspacing='0'><tbody></tbody></table>";$(g.nDiv).css({marginBottom:(E*-1),display:'none',top:F}).noSelect();var G=0;$('th div',g.hDiv).each(function(){var a=$("th[axis='col"+G+"']",g.hDiv)[0];var b='checked="checked"';if(a.style.display=='none')b='';$('tbody',g.nDiv).append('<tr><td class="ndcol1"><input type="checkbox" '+b+' class="togCol" value="'+G+'" /></td><td class="ndcol2">'+this.innerHTML+'</td></tr>');G++});if($.browser.msie&&$.browser.version<7.0)$('tr',g.nDiv).hover(function(){$(this).addClass('ndcolover')},function(){$(this).removeClass('ndcolover')});$('td.ndcol2',g.nDiv).click(function(){if($('input:checked',g.nDiv).length<=p.minColToggle&&$(this).prev().find('input')[0].checked)return false;return g.toggleCol($(this).prev().find('input').val())});$('input.togCol',g.nDiv).click(function(){if($('input:checked',g.nDiv).length<p.minColToggle&&this.checked==false)return false;$(this).parent().next().trigger('click')});$(g.gDiv).prepend(g.nDiv);$(g.nBtn).addClass('nBtn').html('<div></div>').attr('title','Hide/Show Columns').click(function(){$(g.nDiv).toggle();return true});if(p.showToggleBtn)$(g.gDiv).prepend(g.nBtn)}$(g.iDiv).addClass('iDiv').css({display:'none'});$(g.bDiv).append(g.iDiv);$(document).mousemove(function(e){g.dragMove(e)}).mouseup(function(e){g.dragEnd()}).hover(function(){},function(){g.dragEnd()});if($.browser.msie&&$.browser.version<7.0){$('.hDiv,.bDiv,.mDiv,.pDiv,.vGrip,.tDiv, .sDiv',g.gDiv).css({width:'100%'});$(g.gDiv).addClass('ie6');if(p.width!='auto')$(g.gDiv).addClass('ie6fullwidthbug')}g.rePosDrag();g.fixHeight();t.p=p;t.grid=g;if(p.url&&p.autoload){g.populate()}return t};var H=false;$(document).ready(function(){H=true});$.fn.flexigrid=function(p){return this.each(function(){if(!H){$(this).hide();var t=this;$(document).ready(function(){$.addFlex(t,p)})}else{$.addFlex(this,p)}})};$.fn.flexReload=function(p){return this.each(function(){if(this.grid&&this.p.url)this.grid.populate()})};$.fn.flexOptions=function(p){return this.each(function(){if(this.grid)$.extend(this.p,p)})};$.fn.flexToggleCol=function(a,b){return this.each(function(){if(this.grid)this.grid.toggleCol(a,b)})};$.fn.flexAddData=function(a){return this.each(function(){if(this.grid)this.grid.addData(a)})};$.fn.noSelect=function(p){if(p==null)prevent=true;else prevent=p;if(prevent){return this.each(function(){if($.browser.msie||$.browser.safari)$(this).bind('selectstart',function(){return false});else if($.browser.mozilla){$(this).css('MozUserSelect','none');$('body').trigger('focus')}else if($.browser.opera)$(this).bind('mousedown',function(){return false});else $(this).attr('unselectable','on')})}else{return this.each(function(){if($.browser.msie||$.browser.safari)$(this).unbind('selectstart');else if($.browser.mozilla)$(this).css('MozUserSelect','inherit');else if($.browser.opera)$(this).unbind('mousedown');else $(this).removeAttr('unselectable','on')})}}})(jQuery);